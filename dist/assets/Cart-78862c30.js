import{E as B}from"./EditAddOnsModal-50fa91ad.js";import{T as J}from"./Toast-6ec8500e.js";import{k as M,r as p,p as V,o as $,l as A,b as n,c,e,d as f,F as x,i as F,t as m,w as k,m as D,f as C,n as g,h as b}from"./index-2e1d6b55.js";/* empty css                                                                        */const H={dir:"rtl",class:"bg-gray-50 text-right min-h-screen"},L={class:"container mx-auto px-4 py-8"},z={class:"bg-white rounded-xl shadow-lg p-6 mb-6"},P={class:"flex items-center gap-4"},U=["src","alt"],q={class:"font-semibold text-lg"},G={key:0,class:"text-sm text-gray-500"},K={class:"text-primary font-bold"},Q={class:"flex flex-wrap md:flex-nowrap items-center gap-3 md:gap-4 justify-center"},R={class:"flex items-center gap-2"},W=["onClick"],X={class:"mx-2 font-semibold"},Y=["onClick"],Z={class:"flex items-center gap-2 w-full md:w-auto"},tt=["onClick"],et=["onClick"],st={class:"bg-white rounded-xl shadow-lg p-6"},ot={class:"flex justify-between items-center mb-4"},rt={class:"text-2xl font-bold text-primary"},at={class:"w-full bg-primary text-white py-3 rounded-lg font-semibold hover:bg-primary-dark transition text-lg"},nt={key:1,class:"bg-white rounded-xl shadow-lg p-12 text-center"},pt={__name:"Cart",setup(it){M("cart");const i=p({visible:!1,message:"",type:"success"}),l=(o,t="success")=>{i.value={visible:!0,message:o,type:t},setTimeout(()=>i.value.visible=!1,3e3)},_=p(!1),h=p(null),j=o=>{h.value=o,_.value=!0},S=o=>{v()},a=p([]),y=p([]),N=V(()=>a.value.reduce((o,t)=>o+t.total_with_option,0)),v=async()=>{var t;const o=JSON.parse(localStorage.getItem("user")||"{}");try{const s=await g.post("/api/show-cart",{user_id:o.id});a.value=s.data.data,y.value=(t=s.data)==null?void 0:t.providers}catch(s){console.error("Error fetching data:",s)}},I=async o=>{const t=JSON.parse(localStorage.getItem("user")||"{}");try{const s=await g.post("/api/update-to-cart",{user_id:t.id,cart_id:o,count:0,option_ids:[]});l(s.data.msg,"success"),setTimeout(()=>{v()},800)}catch(s){console.error("Error fetching data:",s),l("فشل الاتصال بالخادم","error")}},w=async(o,t)=>{var r;const s=JSON.parse(localStorage.getItem("user")||"{}");if(!(s!=null&&s.id)){l("يجب تسجيل الدخول أولاً","error");return}try{t<=0?(await g.post("/api/update-to-cart",{user_id:s.id,cart_id:o.id,count:0,option_ids:[]}),l("تم إزالة العنصر من السلة","success")):(await g.post("/api/update-to-cart",{user_id:s.id,cart_id:o.id,count:t,option_ids:JSON.stringify((r=o.service_options)==null?void 0:r.map(d=>d.id))||[]}),l("تم تحديث عدد العناصر","success")),setTimeout(()=>{v()},500)}catch(d){console.error("Error updating item count:",d),l("فشل الاتصال بالخادم","error")}},O=o=>{const t=a.value.find(s=>s.id===o);t&&w(t,t.count+1)},E=o=>{const t=a.value.find(s=>s.id===o);t&&w(t,t.count-1)},T=()=>{localStorage.setItem("cart_data",JSON.stringify(a.value)),localStorage.setItem("providers",JSON.stringify(y.value))};return $(()=>{v()}),(o,t)=>{const s=A("router-link");return n(),c(x,null,[e("div",H,[f(B,{open:_.value,item:h.value,onClose:t[0]||(t[0]=r=>_.value=!1),onUpdate:S},null,8,["open","item"]),e("div",L,[t[9]||(t[9]=e("h1",{class:"text-3xl font-bold mb-8"},"سلة المشتريات",-1)),a.value.length?(n(),c(x,{key:0},[e("div",z,[(n(!0),c(x,null,F(a.value,r=>{var d;return n(),c("div",{key:r._key,class:"flex flex-col md:flex-row md:items-center md:justify-between justify-center items-center py-4 border-b last:border-b-0 gap-4"},[e("div",P,[e("img",{src:r.service_image,alt:r.service_title,class:"w-16 h-16 object-contain rounded"},null,8,U),e("div",null,[e("h3",q,m(r.service_title),1),(d=r.service_options)!=null&&d.length?(n(),c("div",G," إضافات: "+m(r.service_options.map(u=>u.title).join("، ")),1)):C("",!0),e("div",K,m(r.total_with_option.toFixed(2))+" د.أ ",1)])]),e("div",Q,[e("div",R,[e("button",{onClick:u=>E(r.id),class:"bg-gray-200 rounded px-3 py-1"}," - ",8,W),e("span",X,m(r.count),1),e("button",{onClick:u=>O(r.id),class:"bg-gray-200 rounded px-3 py-1"}," + ",8,Y)]),e("div",Z,[e("button",{onClick:u=>j(r),class:"text-primary hover:text-white text-sm flex items-center gap-1 px-3 py-1 rounded border border-primary hover:bg-primary transition-colors w-full md:w-auto justify-center"},t[1]||(t[1]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),b(" تعديل الإضافات ",-1)]),8,tt),e("button",{onClick:u=>I(r.id),class:"text-red-500 hover:text-red-700 w-full md:w-auto flex justify-center"},t[2]||(t[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,et)])])])}),128))]),e("div",st,[e("div",ot,[t[3]||(t[3]=e("span",{class:"text-xl font-bold"},"الإجمالي:",-1)),e("span",rt,m(N.value.toFixed(2))+" د.أ",1)]),e("button",at,[f(s,{onClick:T,to:"/checkout",class:"block w-full h-full flex items-center justify-center"},{default:k(()=>t[4]||(t[4]=[b(" إتمام الطلب ",-1)])),_:1,__:[4]})])])],64)):(n(),c("div",nt,[t[6]||(t[6]=e("div",{class:"text-6xl mb-4"},"🛒",-1)),t[7]||(t[7]=e("h2",{class:"text-2xl font-bold mb-2"},"سلتك فارغة",-1)),t[8]||(t[8]=e("p",{class:"text-gray-500 mb-6"}," لم تقم بإضافة أي منتجات إلى السلة بعد ",-1)),f(s,{to:"/",class:"bg-primary text-white px-6 py-3 rounded-lg font-semibold hover:bg-primary-dark transition"},{default:k(()=>t[5]||(t[5]=[b(" تصفح المنتجات ",-1)])),_:1,__:[5]})]))])]),i.value.visible?(n(),D(J,{key:0,message:i.value.message,type:i.value.type,visible:i.value.visible},null,8,["message","type","visible"])):C("",!0)],64)}}};export{pt as default};
