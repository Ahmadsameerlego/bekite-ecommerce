import{_ as j,r as g,p as y,j as N,b as u,c as m,d as T,w as B,e as t,t as p,F as x,i as E,q as M,g as S,y as A,f as h,T as V,m as $,n as I}from"./index-2e1d6b55.js";import{T as O}from"./Toast-6ec8500e.js";/* empty css                                                                        */const z={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"},D={class:"bg-white rounded-2xl shadow-xl w-full max-w-md mx-4 p-6 relative",dir:"rtl"},F={class:"text-center mb-6"},J={class:"text-gray-600"},L={class:"mb-6"},q=["src","alt"],P={class:"mb-6"},U={class:"space-y-3 max-h-48 overflow-y-auto"},G={class:"flex items-center gap-3"},H=["value"],K={class:"font-semibold text-gray-900"},Q={class:"text-primary font-bold"},R={class:"border-t pt-4 mb-6"},W={class:"flex justify-between items-center"},X={class:"text-2xl font-bold text-primary"},Y={class:"flex gap-3"},Z={__name:"EditAddOnsModal",props:{open:{type:Boolean,default:!1},item:{type:Object,default:null}},emits:["close","update"],setup(c,{emit:_}){const l=c,r=g({visible:!1,message:"",type:"success"}),v=(s,e="success")=>{r.value={visible:!0,message:s,type:e},setTimeout(()=>r.value.visible=!1,3e3)},f=_,b=y(()=>{var s;return((s=l.item)==null?void 0:s.service_options)||[]}),n=g([]);N(()=>l.open,s=>{s&&l.item&&(n.value=b.value.filter(e=>e.selectd===!0).map(e=>e.id))});const w=y(()=>{var a,o;const s=Number((o=(a=l.item)==null?void 0:a.product)==null?void 0:o.price_with_value)||0,e=b.value.filter(d=>n.value.includes(d.id)).reduce((d,i)=>d+Number(i.price_with_value||0),0);return s+e}),k=async()=>{var e,a;const s=JSON.parse(localStorage.getItem("user")||"{}");if(!(s!=null&&s.id)){v("يجب تسجيل الدخول أولاً","error");return}try{const o=await I.post("/api/update-to-cart",{user_id:s.id,cart_id:(e=l.item)==null?void 0:e.id,count:((a=l.item)==null?void 0:a.count)||0,option_ids:JSON.stringify(n.value)||[]});v("تم تحديث عدد العناصر","success"),setTimeout(()=>{f("close"),f("update",o.data.data)},500)}catch(o){console.error("Error updating item count:",o),v("فشل الاتصال بالخادم","error")}};return(s,e)=>(u(),m(x,null,[T(V,{name:"fade-slide"},{default:B(()=>{var a,o,d;return[c.open?(u(),m("div",z,[t("div",D,[t("button",{class:"absolute top-3 left-3 text-gray-400 hover:text-gray-700 bg-white rounded-full p-1 shadow-md hover:shadow-lg transition-all",onClick:e[0]||(e[0]=i=>s.$emit("close"))},e[3]||(e[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),t("div",F,[e[4]||(e[4]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"تعديل الإضافات",-1)),t("p",J,p((a=c.item)==null?void 0:a.service_title),1)]),t("div",L,[t("img",{src:(o=c.item)==null?void 0:o.service_image,alt:(d=c.item)==null?void 0:d.service_title,class:"w-full h-32 object-contain rounded-lg"},null,8,q)]),t("div",P,[e[5]||(e[5]=t("h3",{class:"text-lg font-semibold mb-4"},"اختر الإضافات",-1)),t("div",U,[(u(!0),m(x,null,E(b.value,i=>(u(),m("label",{key:i.id,class:M(["flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:border-primary transition-all cursor-pointer",{"border-primary bg-orange-50":n.value.includes(i)}])},[t("div",G,[S(t("input",{type:"checkbox",value:i.id,"onUpdate:modelValue":e[1]||(e[1]=C=>n.value=C),class:"w-4 h-4 text-primary focus:ring-primary border-gray-300 rounded"},null,8,H),[[A,n.value]]),t("div",null,[t("div",K,p(i.title),1)])]),t("div",Q,"+"+p(i.price_with_value)+" د.أ",1)],2))),128))])]),t("div",R,[t("div",W,[e[6]||(e[6]=t("span",{class:"text-lg font-semibold"},"السعر الإجمالي:",-1)),t("span",X,p(w.value)+" د.أ",1)])]),t("div",Y,[t("button",{onClick:k,class:"flex-1 bg-primary text-white py-3 rounded-xl font-semibold hover:bg-primary-dark transition-colors"}," تحديث الإضافات "),t("button",{onClick:e[2]||(e[2]=i=>s.$emit("close")),class:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-colors"}," إلغاء ")])])])):h("",!0)]}),_:1}),r.value.visible?(u(),$(O,{key:0,message:r.value.message,type:r.value.type,visible:r.value.visible},null,8,["message","type","visible"])):h("",!0)],64))}},oe=j(Z,[["__scopeId","data-v-fa703af4"]]);export{oe as E};
